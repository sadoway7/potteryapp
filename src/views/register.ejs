<h2>Register</h2>
<% if (error) { %>
  <div class="alert alert-error">
    <%= error %>
  </div>
<% } %>
<form action="/api/auth/register" method="POST" class="form-stacked" onsubmit="return validatePasswords()">
    <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" value="<%= email || '' %>" required>
    </div>
    <div class="form-group">
        <label for="password">Password (min 8 characters)</label>
        <input type="password" id="password" name="password" required minlength="8">
        <p id="password-error" class="error-message"></p>
    </div>
    <div class="form-group">
        <label for="confirm-password">Confirm Password</label>
        <input type="password" id="confirm-password" name="confirm-password" required>
        <p id="confirm-error" class="error-message"></p>
    </div>
    <button type="submit" class="btn-primary">Register</button>
</form>
<p>Already have an account? <a href="/login">Login here</a>.</p>

<script>
function validateForm() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirm-password').value;
    const emailError = document.getElementById('email-error');
    const passwordError = document.getElementById('password-error');
    const confirmError = document.getElementById('confirm-error');
    
    // Clear previous errors
    emailError.textContent = '';
    passwordError.textContent = '';
    confirmError.textContent = '';
    
    let isValid = true;
    
    // Email validation
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        emailError.textContent = 'Please enter a valid email address';
        isValid = false;
    }
    
    // Password strength validation
    if (password.length < 8) {
        passwordError.textContent = 'Password must be at least 8 characters';
        isValid = false;
    } else if (!/[A-Z]/.test(password)) {
        passwordError.textContent = 'Password must contain at least one uppercase letter';
        isValid = false;
    } else if (!/[0-9]/.test(password)) {
        passwordError.textContent = 'Password must contain at least one number';
        isValid = false;
    }
    
    // Password match validation
    if (password !== confirmPassword) {
        confirmError.textContent = 'Passwords do not match';
        isValid = false;
    }
    
    return isValid;
}

// Add real-time validation
document.getElementById('email').addEventListener('blur', validateForm);
document.getElementById('password').addEventListener('input', validateForm);
document.getElementById('confirm-password').addEventListener('input', validateForm);
</script>
